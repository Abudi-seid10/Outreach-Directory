{% extends 'base.html' %}

{% block title %}Import Stakeholders{% endblock %}

{% block content %}
<div class="container mt-4">
    <div class="row">
        <div class="col-md-12">
            <div class="card shadow-sm">
                <div class="card-header bg-primary text-white">
                    <h4 class="mb-0">Import Stakeholders from CSV</h4>
                </div>
                <div class="card-body">
                    <div class="alert alert-info">
                        <h5>CSV File Requirements:</h5>
                        <p>Your CSV file should include the following columns (header row is required):</p>
                        <div class="table-responsive">
                            <table class="table table-sm table-bordered">
                                <thead>
                                    <tr>
                                        <th>Column Name</th>
                                        <th>Description</th>
                                        <th>Required</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>Name</td>
                                        <td>Stakeholder's full name</td>
                                        <td>Yes</td>
                                    </tr>
                                    <tr>
                                        <td>Email</td>
                                        <td>Stakeholder's email address (used as unique identifier)</td>
                                        <td>Yes</td>
                                    </tr>
                                    <tr>
                                        <td>Phone</td>
                                        <td>Stakeholder's phone number</td>
                                        <td>No</td>
                                    </tr>
                                    <tr>
                                        <td>Organization</td>
                                        <td>Stakeholder's organization</td>
                                        <td>No</td>
                                    </tr>
                                    <tr>
                                        <td>Role</td>
                                        <td>Stakeholder's role</td>
                                        <td>No</td>
                                    </tr>
                                    <tr>
                                        <td>Notes</td>
                                        <td>Additional notes</td>
                                        <td>No</td>
                                    </tr>
                                    <tr>
                                        <td>Partnership Model</td>
                                        <td>Type of partnership</td>
                                        <td>No</td>
                                    </tr>
                                    <tr>
                                        <td>Relation Model</td>
                                        <td>Relationship model</td>
                                        <td>No</td>
                                    </tr>
                                    <tr>
                                        <td>Relevance / Priority</td>
                                        <td>Priority level (1-5)</td>
                                        <td>No</td>
                                    </tr>
                                    <tr>
                                        <td>Stakeholder Segment</td>
                                        <td>Segment category (e.g., Government & Regulatory, Academic Institutions)</td>
                                        <td>No</td>
                                    </tr>
                                    <tr>
                                        <td>Stakeholder Sub-sector</td>
                                        <td>Sub-sector information</td>
                                        <td>No</td>
                                    </tr>
                                    <tr>
                                        <td>Stakeholder Technology Expertise</td>
                                        <td>Technology expertise areas</td>
                                        <td>No</td>
                                    </tr>
                                    <tr>
                                        <td>Stakeholder Location</td>
                                        <td>Geographic location</td>
                                        <td>No</td>
                                    </tr>
                                    <tr>
                                        <td>Stakeholder Annual Turnover (USD)</td>
                                        <td>Annual turnover in USD</td>
                                        <td>No</td>
                                    </tr>
                                    <tr>
                                        <td>Stakeholder Number of Employees</td>
                                        <td>Number of employees (numeric value)</td>
                                        <td>No</td>
                                    </tr>
                                    <tr>
                                        <td>Projected Year of Market Entry</td>
                                        <td>Year of projected market entry</td>
                                        <td>No</td>
                                    </tr>
                                    <tr>
                                        <td>Engagement Status</td>
                                        <td>Current engagement status (e.g., Engaged, Not engaged)</td>
                                        <td>No</td>
                                    </tr>
                                    <tr>
                                        <td>Ark Vertical Outreach Manager</td>
                                        <td>Name of outreach manager</td>
                                        <td>No</td>
                                    </tr>
                                    <tr>
                                        <td>Stakeholder Contact Person</td>
                                        <td>Primary contact person name</td>
                                        <td>No</td>
                                    </tr>
                                    <tr>
                                        <td>Stakeholder Contact Role</td>
                                        <td>Role of the contact person</td>
                                        <td>No</td>
                                    </tr>
                                    <tr>
                                        <td>Stakeholder Contact Number</td>
                                        <td>Contact person's phone number</td>
                                        <td>No</td>
                                    </tr>
                                    <tr>
                                        <td>Stakeholder Contact Email</td>
                                        <td>Contact person's email</td>
                                        <td>No</td>
                                    </tr>
                                    <tr>
                                        <td>Stakeholder Website</td>
                                        <td>Organization website</td>
                                        <td>No</td>
                                    </tr>
                                    <tr>
                                        <td>Potential Stakeholder Relationship(s)</td>
                                        <td>Potential relationship types</td>
                                        <td>No</td>
                                    </tr>
                                    <tr>
                                        <td>Actual Stakeholder Relationship(s)</td>
                                        <td>Current relationship types</td>
                                        <td>No</td>
                                    </tr>
                                    <tr>
                                        <td>Potential Engagement Activities</td>
                                        <td>Potential activities for engagement</td>
                                        <td>No</td>
                                    </tr>
                                    <tr>
                                        <td>Actual Engagement Activities</td>
                                        <td>Current engagement activities</td>
                                        <td>No</td>
                                    </tr>
                                    <tr>
                                        <td>Tools & Collaterals</td>
                                        <td>Tools and materials used</td>
                                        <td>No</td>
                                    </tr>
                                    <tr>
                                        <td>Expected Outcomes</td>
                                        <td>Expected outcomes from engagement</td>
                                        <td>No</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    
                    <div class="mt-3">
                        <a href="javascript:void(0)" onclick="downloadTemplate()" class="btn btn-outline-primary mb-3">
                            <i class="fas fa-download"></i> Download Sample Template
                        </a>
                    </div>

                    <form method="post" enctype="multipart/form-data" class="mt-4">
                        {% csrf_token %}
                        <div class="mb-3">
                            <label for="csv_file" class="form-label">Select CSV File</label>
                            <input type="file" class="form-control" id="csv_file" name="csv_file" accept=".csv" required>
                            <div class="form-text">Only CSV files are accepted.</div>
                        </div>
                        <div class="d-flex justify-content-between">
                            <button type="submit" class="btn btn-primary">
                                <i class="fas fa-upload"></i> Import
                            </button>
                            <a href="{% url 'stakeholder_list' %}" class="btn btn-secondary">
                                <i class="fas fa-arrow-left"></i> Back to List
                            </a>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    function downloadTemplate() {
        // Create CSV content with headers
        const headers = [
            'Name', 'Email', 'Phone', 'Organization', 'Role', 'Notes',
            'Partnership Model', 'Relation Model', 'Relevance / Priority',
            'Stakeholder Segment', 'Stakeholder Sub-sector', 'Stakeholder Technology Expertise',
            'Stakeholder Location', 'Stakeholder Annual Turnover (USD)', 'Stakeholder Number of Employees',
            'Projected Year of Market Entry', 'Engagement Status', 'Ark Vertical Outreach Manager',
            'Stakeholder Contact Person', 'Stakeholder Contact Role', 'Stakeholder Contact Number',
            'Stakeholder Contact Email', 'Stakeholder Website', 'Potential Stakeholder Relationship(s)',
            'Actual Stakeholder Relationship(s)', 'Potential Engagement Activities',
            'Actual Engagement Activities', 'Tools & Collaterals', 'Expected Outcomes'
        ];
        
        // Sample data row
        const sampleData = [
            'John Doe', 'john.doe@example.com', '+1234567890', 'Example Corp', 'CEO', 'Important contact',
            'Strategic Partner', 'Direct', '1',
            'Government & Regulatory', 'Ministry of Transport', 'Drone Technology',
            'Addis Ababa', '1000000', '50',
            '2024', 'Engaged', 'Faiz',
            'Jane Smith', 'Director', '+0987654321',
            'jane.smith@example.com', 'www.examplecorp.com', 'Enabler and legal/regulatory partner',
            'Policy partner', 'Policy dialogues, demo days',
            'Mini-pilots', 'Advocacy deck, regulatory impact reports', 'Regulatory support, pilot approval'
        ];
        
        // Create CSV content
        let csvContent = headers.join(',') + '\n' + sampleData.join(',');
        
        // Create a blob and download link
        const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
        const url = URL.createObjectURL(blob);
        const link = document.createElement('a');
        link.setAttribute('href', url);
        link.setAttribute('download', 'stakeholders_template.csv');
        link.style.visibility = 'hidden';
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
    }
</script>
{% endblock %}